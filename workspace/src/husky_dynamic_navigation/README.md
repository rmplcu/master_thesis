# Husky dynamic Navigation package

This package can be used to spawn and move two huskies with their separate navigation stacks in a gazebo environment.

Each robot is equipped with a realsense 3d camera on the front and two 2d lasers on the side. The pointcloud generated by the camera is converted to a 2d laser with the [pointcloud_to_laserscan](https://wiki.ros.org/pointcloud_to_laserscan) package. In order to have only one topic for the laserscan, the three topics (scan_camera, scan_left, scan_right) are merged into one using the [laser_multi_merger](http://wiki.ros.org/ira_laser_tools).

Run ``` roslaunch husky_dynamic_navigation husky_dynamic_navigation.launch world_name=<world_name>``` to spawn the huskies in the gazebo world *<world_name>*. *<world_name>* can be selected from one of the following: *playpen*, *narrow_corridor*, *narrow_corridors*. 

## Configuration files

Here is the list of the configuration files and their use.

- [amcl_params.yaml](config/amcl_params.yaml): configuration file for amcl package.
- [control_husky1.yaml](config/control_husky1.yaml): used to set the physics parameters of the first robot, such as max speed, max accelleration, etc. 
- [control_husky2.yaml](config/control_husky2.yaml): used to set the physics parameter of the second robot, such as max speed, max accelleration, etc
- [costmap_common.yaml](config/costmap_common.yaml): contains the parameters that both local and global costmap use.
- [costmap_global_static.yaml](config/costmap_global_static.yaml): contains the parameter used only by the global costmap.
- [costmap_local.yaml](config/costmap_local.yaml): contains the parameter used only by the local costmap.
- [localization_husky1.yaml](config/localization_husky1.yaml): specifies the parameters used for localization of the first husky, such as odom and imu parameters.
- [localization_husky2.yaml](config/localization_husky2.yaml): specifies the parameters used for localization of the second husky, such as odom and imu parameters.
- [planner.yaml](config/planner.yaml): contains the parameters for the local and global planners.
- [rviz.rviz](config/rviz.rviz): the save file of RVIZ.
- [SimpleMPCLocalPlanner_husky1.yaml](config/SimpleMPCLocalPlanner_husky1.yaml): the configuration file for the [SimpleMPCLocalPlanner](/workspace/src/simple_mpc_local_planner/README.md) local planner of the first husky.
- [SimpleMPCLocalPlanner_husky2.yaml](config/SimpleMPCLocalPlanner_husky2.yaml): the configuration file for the [SimpleMPCLocalPlanner](/workspace/src/simple_mpc_local_planner/README.md) local planner of the second husky.
- [twist_mux_husky1.yaml](config/twist_mux_husky1.yaml): contains the parameter for the interactive marker, joy teleop and external stop for the first robot.
- [twist_mux_husky2.yaml](config/twist_mux_husky2.yaml): contains the parameter for the interactive marker, joy teleop and external stop for the second robot.

## Launch files

- **husky_dynamic_navigation**: the main launch file.

- **husky_control**: used to initialize the huskies. Loads the robot description and the control_husky1.yaml (or control_husky2.yaml). Spawns the nodes laser_multimerger, pointcloud_to_laserscan, base_controller_spawner, efk_localization, interactive_marker, state_publisher and twist_mux.

## Map files

The map file for each world are generated with [gazebo_ros_2DMap_plugin](https://github.com/marinaKollmitz/gazebo_ros_2Dmap_plugin).

## Scripts

## Urdf files

- [hokuyo_ust10.urdf.xacro](urdf/hokuyo_ust10.urdf.xacro): the urdf file of the 2d laser.
- [husky.urdf.xacro](urdf/husky.urdf.xacro): the husky urdf file.

## World files

Three world are present in this package.

- *playpen.world*: a general outdoor warehouse world, with an obstacle (representing a human) moving along a predefined path.
- *narrow_corridor.world*: a world with two big rooms connected with a narrow corridor.
- *narrow_corridors.world*: a world with two big rooms connected with two narrow corridors.